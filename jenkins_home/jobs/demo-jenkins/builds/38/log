Started by user [8mha:////4Grxr5YEoTU2x6PmVe18EB2Sv5GUMelkrtMFjDY3jKFIAAAAlx+LCAAAAAAAAP9b85aBtbiIQTGjNKU4P08vOT+vOD8nVc83PyU1x6OyILUoJzMv2y+/JJUBAhiZGBgqihhk0NSjKDWzXb3RdlLBUSYGJk8GtpzUvPSSDB8G5tKinBIGIZ+sxLJE/ZzEvHT94JKizLx0a6BxUmjGOUNodHsLgAy+EgZu/dLi1CL9xJTczDwAcQdo88AAAAA=[0mPháº¡m VÄƒn Doanh
Building in workspace /var/jenkins_home/workspace/demo-jenkins
No credentials specified
 > git rev-parse --is-inside-work-tree # timeout=10
Fetching changes from the remote Git repository
 > git config remote.origin.url git@github.com:vandoanh/demo-jenkins.git # timeout=10
Fetching upstream changes from git@github.com:vandoanh/demo-jenkins.git
 > git --version # timeout=10
 > git fetch --tags --progress git@github.com:vandoanh/demo-jenkins.git +refs/heads/*:refs/remotes/origin/*
 > git rev-parse refs/remotes/origin/master^{commit} # timeout=10
 > git rev-parse refs/remotes/origin/origin/master^{commit} # timeout=10
Checking out Revision 144fedf62ab0f4d8ad3b2553a677dbb735714a1b (refs/remotes/origin/master)
 > git config core.sparsecheckout # timeout=10
 > git checkout -f 144fedf62ab0f4d8ad3b2553a677dbb735714a1b
Commit message: "laravel"
 > git rev-list --no-walk 9bc5c4d2fe49993ad406246bdd84e7cd5ea2311c # timeout=10
[demo-jenkins] $ /bin/sh -xe /tmp/jenkins8327581050528707851.sh
+ sh setup_docker.sh
Install docker
Warning: apt-key output should not be parsed (stdout is not a terminal)
OK
setup_docker.sh: 5: setup_docker.sh: lsb_release: not found
setup_docker.sh: 5: setup_docker.sh: add-apt-repository: not found
Ign:1 http://deb.debian.org/debian stretch InRelease
Hit:2 http://deb.debian.org/debian stretch-updates InRelease
Hit:3 http://security.debian.org/debian-security stretch/updates InRelease
Hit:4 http://deb.debian.org/debian stretch Release
Reading package lists...
Reading package lists...
Building dependency tree...
Reading state information...
E: Unable to locate package docker-ce
Add user to group docker
usermod: group 'docker' does not exist
Install docker-compose
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   617    0   617    0     0    981      0 --:--:-- --:--:-- --:--:--   982
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0  0 11.2M    0 16360    0     0   8787      0  0:22:16  0:00:01  0:22:15 16294  3 11.2M    3  407k    0     0   133k      0  0:01:25  0:00:03  0:01:22  185k  5 11.2M    5  661k    0     0   165k      0  0:01:09  0:00:03  0:01:06  211k  8 11.2M    8  968k    0     0   196k      0  0:00:58  0:00:04  0:00:54  237k 10 11.2M   10 1172k    0     0   199k      0  0:00:57  0:00:05  0:00:52  233k 11 11.2M   11 1376k    0     0   201k      0  0:00:56  0:00:06  0:00:50  274k 13 11.2M   13 1546k    0     0   197k      0  0:00:58  0:00:07  0:00:51  238k 14 11.2M   14 1631k    0     0   183k      0  0:01:02  0:00:08  0:00:54  197k 14 11.2M   14 1716k    0     0   174k      0  0:01:05  0:00:09  0:00:56  152k 15 11.2M   15 1818k    0     0   167k      0  0:01:08  0:00:10  0:00:58  130k 16 11.2M   16 1937k    0     0   163k      0  0:01:10  0:00:11  0:00:59  111k 18 11.2M   18 2073k    0     0   160k      0  0:01:11  0:00:12  0:00:59  102k 19 11.2M   19 2192k    0     0   157k      0  0:01:12  0:00:13  0:00:59  111k 20 11.2M   20 2311k    0     0   155k      0  0:01:13  0:00:14  0:00:59  119k 21 11.2M   21 2464k    0     0   155k      0  0:01:13  0:00:15  0:00:58  128k 22 11.2M   22 2617k    0     0   155k      0  0:01:13  0:00:16  0:00:57  136k 24 11.2M   24 2786k    0     0   156k      0  0:01:13  0:00:17  0:00:56  145k 25 11.2M   25 2940k    0     0   156k      0  0:01:13  0:00:18  0:00:55  151k 27 11.2M   27 3160k    0     0   159k      0  0:01:12  0:00:19  0:00:53  168k 29 11.2M   29 3348k    0     0   160k      0  0:01:11  0:00:20  0:00:51  177k 31 11.2M   31 3586k    0     0   164k      0  0:01:09  0:00:21  0:00:48  192k 33 11.2M   33 3824k    0     0   167k      0  0:01:08  0:00:22  0:00:46  208k 35 11.2M   35 4095k    0     0   171k      0  0:01:06  0:00:23  0:00:43  230k 37 11.2M   37 4351k    0     0   175k      0  0:01:05  0:00:24  0:00:41  239k 40 11.2M   40 4622k    0     0   178k      0  0:01:04  0:00:25  0:00:39  254k 42 11.2M   42 4929k    0     0   183k      0  0:01:02  0:00:26  0:00:36  269k 46 11.2M   46 5286k    0     0   189k      0  0:01:00  0:00:27  0:00:33  292k 50 11.2M   50 5779k    0     0   200k      0  0:00:57  0:00:28  0:00:29  337k 56 11.2M   56 6442k    0     0   215k      0  0:00:53  0:00:29  0:00:24  417k 61 11.2M   61 7105k    0     0   230k      0  0:00:49  0:00:30  0:00:19  496k 68 11.2M   68 7870k    0     0   246k      0  0:00:46  0:00:31  0:00:15  577k 74 11.2M   74 8499k    0     0   258k      0  0:00:44  0:00:32  0:00:12  642k 78 11.2M   78 8992k    0     0   265k      0  0:00:43  0:00:33  0:00:10  642k 81 11.2M   81 9331k    0     0   267k      0  0:00:42  0:00:34  0:00:08  577k 83 11.2M   83 9621k    0     0   268k      0  0:00:42  0:00:35  0:00:07  502k 85 11.2M   85 9825k    0     0   266k      0  0:00:43  0:00:36  0:00:07  397k 87 11.2M   87  9.8M    0     0   265k      0  0:00:43  0:00:37  0:00:06  308k 89 11.2M   89 10.0M    0     0   263k      0  0:00:43  0:00:38  0:00:05  251k 90 11.2M   90 10.1M    0     0   261k      0  0:00:43  0:00:39  0:00:04  220k 92 11.2M   92 10.3M    0     0   259k      0  0:00:44  0:00:40  0:00:04  194k 93 11.2M   93 10.4M    0     0   256k      0  0:00:44  0:00:41  0:00:03  183k 94 11.2M   94 10.6M    0     0   254k      0  0:00:45  0:00:42  0:00:03  170k 96 11.2M   96 10.8M    0     0   252k      0  0:00:45  0:00:43  0:00:02  162k 98 11.2M   98 10.9M    0     0   250k      0  0:00:45  0:00:44  0:00:01  163k 99 11.2M   99 11.1M    0     0   249k      0  0:00:45  0:00:45 --:--:--  173k100 11.2M  100 11.2M    0     0   249k      0  0:00:45  0:00:45 --:--:--  179k
Run docker
Building php-fpm
Step 1/27 : FROM php:7.1-fpm
 ---> 500905b2d394
Step 2/27 : LABEL maintainer="Do Quyet Tien <doquyettien@gmail.com>"
 ---> Using cache
 ---> dad7cf351a91
Step 3/27 : RUN apt-get update &&     apt-get upgrade -y &&     apt-get install -y     sudo     vim     git     curl     libmemcached-dev     libz-dev     libpq-dev     libjpeg-dev     libpng-dev     libfreetype6-dev     libssl-dev     libmcrypt-dev     libgmp-dev     libzip-dev zip unzip &&     docker-php-ext-install pdo_mysql &&     docker-php-ext-configure zip --with-libzip &&     docker-php-ext-install zip &&     php -m | grep -q 'zip'     && docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/     && docker-php-ext-install -j$(nproc) gd     && docker-php-ext-install pcntl     && docker-php-ext-install bcmath     && docker-php-ext-install gmp     && docker-php-ext-install exif     && docker-php-ext-install mysqli     && docker-php-ext-install mcrypt     && rm -rf /var/lib/apt/lists/*
 ---> Using cache
 ---> 575ad0e2bc0a
Step 4/27 : ARG TZ=UTC
 ---> Using cache
 ---> b0374cfea851
Step 5/27 : ENV TZ ${TZ}
 ---> Using cache
 ---> 0b1f26a2238d
Step 6/27 : RUN ln -snf /usr/share/zoneinfo/$TZ /etc/localtime && echo $TZ > /etc/timezone
 ---> Using cache
 ---> f52c31c642fe
Step 7/27 : RUN pecl install -o -f redis     && rm -rf /tmp/pear     && docker-php-ext-enable redis
 ---> Using cache
 ---> 9d10eea5925f
Step 8/27 : RUN curl -L -o /tmp/memcached.tar.gz "https://github.com/php-memcached-dev/php-memcached/archive/php7.tar.gz"     && mkdir -p memcached     && tar -C memcached -zxvf /tmp/memcached.tar.gz --strip 1     && (         cd memcached         && phpize         && ./configure         && make -j$(nproc)         && make install     )     && rm -r memcached     && rm /tmp/memcached.tar.gz     && docker-php-ext-enable memcached
 ---> Using cache
 ---> 479e8b1b3f23
Step 9/27 : RUN docker-php-ext-install opcache
 ---> Using cache
 ---> af591b1d817f
Step 10/27 : COPY ./opcache.ini /usr/local/etc/php/conf.d/opcache.ini
 ---> Using cache
 ---> 22cf7894cf0d
Step 11/27 : USER root
 ---> Using cache
 ---> 3521a6c1fc57
Step 12/27 : RUN apt-get update -yqq &&     apt-get -y install mysql-client
 ---> Using cache
 ---> b1dcf17d394e
Step 13/27 : RUN curl -sL https://deb.nodesource.com/setup_11.x | bash - &&     apt-get -y install nodejs
 ---> Using cache
 ---> 890c091ef324
Step 14/27 : RUN node -v && npm -v
 ---> Using cache
 ---> aca8d63bc210
Step 15/27 : RUN curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer
 ---> Using cache
 ---> 710529d9fa25
Step 16/27 : USER root
 ---> Using cache
 ---> 73167f06a20f
Step 17/27 : COPY ./crontab /etc/cron.d
 ---> Using cache
 ---> eb759c24fc7e
Step 18/27 : RUN chmod -R 644 /etc/cron.d
 ---> Using cache
 ---> 49777fa9d5db
Step 19/27 : RUN set -xe; php -v | head -n 1 | grep -q "PHP ${PHP_VERSION}."
 ---> Using cache
 ---> 659300d754aa
Step 20/27 : COPY ./laravel.ini /usr/local/etc/php/conf.d
 ---> Using cache
 ---> 024f2e8cb8d9
Step 21/27 : COPY ./php.ini /usr/local/etc/php/php.ini
 ---> Using cache
 ---> 19d3cb360aaf
Step 22/27 : USER root
 ---> Using cache
 ---> c882e8cadf21
Step 23/27 : RUN apt-get clean &&     rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* &&     rm /var/log/lastlog /var/log/faillog
 ---> Using cache
 ---> a0ef9356dfe0
Step 24/27 : RUN usermod -u 1000 www-data
 ---> Using cache
 ---> 194ef1cceeeb
Step 25/27 : WORKDIR /usr/share/nginx/html/blog
 ---> Using cache
 ---> f9a94a364e10
Step 26/27 : CMD ["php-fpm"]
 ---> Using cache
 ---> db566b0d51fa
Step 27/27 : EXPOSE 9000
 ---> Using cache
 ---> 4d082b776b3c
Successfully built 4d082b776b3c
Successfully tagged blog_php-fpm:latest
Building nginx
Step 1/16 : FROM nginx
 ---> 881bd08c0b08
Step 2/16 : LABEL maintainer="Do Quyet Tien <doquyettien@gmail.com>"
 ---> Using cache
 ---> 909923a4d87b
Step 3/16 : ARG PHP_UPSTREAM_CONTAINER=php-fpm
 ---> Using cache
 ---> 59fa9479d039
Step 4/16 : ARG PHP_UPSTREAM_PORT=9000
 ---> Using cache
 ---> de101b956b89
Step 5/16 : RUN apt-get update     && apt-get upgrade     && apt-get -y install openssl     bash     vim     curl     && adduser -H -u 1000 -s /bin/bash www-data
 ---> Using cache
 ---> 49f95b9e662d
Step 6/16 : ARG TZ=UTC
 ---> Using cache
 ---> 7db1701a0ee8
Step 7/16 : ENV TZ ${TZ}
 ---> Using cache
 ---> d901a8f4ecf9
Step 8/16 : RUN ln -snf /usr/share/zoneinfo/$TZ /etc/localtime && echo $TZ > /etc/timezone
 ---> Using cache
 ---> 9c7b577423a8
Step 9/16 : RUN echo "upstream php-upstream { server ${PHP_UPSTREAM_CONTAINER}:${PHP_UPSTREAM_PORT}; }" > /etc/nginx/conf.d/upstream.conf     && rm /etc/nginx/conf.d/default.conf
 ---> Using cache
 ---> 23399f5fa8e1
Step 10/16 : COPY ./nginx.conf /etc/nginx/
 ---> Using cache
 ---> 67c47ba573f5
Step 11/16 : COPY ./fastcgi.conf /etc/nginx/
 ---> Using cache
 ---> f74a7d8bb2b6
Step 12/16 : COPY ./app.conf /etc/nginx/conf.d
 ---> Using cache
 ---> 909859d834f0
Step 13/16 : RUN curl -L -o /tmp/phpMyAdmin.tar.gz "https://www.phpmyadmin.net/downloads/phpMyAdmin-latest-english.tar.gz"     && mkdir -p /usr/share/nginx/html/phpMyAdmin     && tar -C /usr/share/nginx/html/phpMyAdmin -zxvf /tmp/phpMyAdmin.tar.gz --strip 1     && rm /tmp/phpMyAdmin.tar.gz
 ---> Using cache
 ---> 56241b36bb91
Step 14/16 : RUN curl -L -o /usr/share/nginx/html/adminer.php "https://github.com/vrana/adminer/releases/download/v4.7.1/adminer-4.7.1-mysql-en.php"
 ---> Using cache
 ---> e34d82d46f81
Step 15/16 : CMD ["nginx"]
 ---> Using cache
 ---> 9a68c59073ba
Step 16/16 : EXPOSE 80 443 9100
 ---> Using cache
 ---> 1c2bbd8fbd2b
Successfully built 1c2bbd8fbd2b
Successfully tagged blog_nginx:latest
Building mysql
Step 1/9 : ARG MYSQL_VERSION=latest
Step 2/9 : FROM mysql:${MYSQL_VERSION}
 ---> ee7cbd482336
Step 3/9 : LABEL maintainer="Do Quyet Tien <doquyettien@gmail.com>"
 ---> Using cache
 ---> 888d9b89aca5
Step 4/9 : ARG TZ=UTC
 ---> Using cache
 ---> ce77a98d4b5b
Step 5/9 : ENV TZ ${TZ}
 ---> Using cache
 ---> 22235d0162e3
Step 6/9 : RUN ln -snf /usr/share/zoneinfo/$TZ /etc/localtime && echo $TZ > /etc/timezone && chown -R mysql:root /var/lib/mysql/
 ---> Using cache
 ---> 573a061801b5
Step 7/9 : COPY my.cnf /etc/mysql/conf.d/my.cnf
 ---> Using cache
 ---> 24d7f8848c26
Step 8/9 : CMD ["mysqld"]
 ---> Using cache
 ---> 2aa78d8548f7
Step 9/9 : EXPOSE 3306
 ---> Using cache
 ---> 0570aacbcf75
Successfully built 0570aacbcf75
Successfully tagged blog_mysql:latest
Building redis
Step 1/7 : FROM redis:latest
 ---> 4161e91dcc29
Step 2/7 : LABEL maintainer="Do Quyet Tien <doquyettien@gmail.com>"
 ---> Using cache
 ---> 73d08ef1be96
Step 3/7 : RUN mkdir -p /usr/local/etc/redis
 ---> Using cache
 ---> 6e08330612b3
Step 4/7 : COPY redis.conf /usr/local/etc/redis/redis.conf
 ---> Using cache
 ---> 813db768e4e4
Step 5/7 : VOLUME /data
 ---> Using cache
 ---> d09f0866bc2f
Step 6/7 : EXPOSE 6379
 ---> Using cache
 ---> 8c9348fe0a42
Step 7/7 : CMD ["redis-server"]
 ---> Using cache
 ---> d299f3416156
Successfully built d299f3416156
Successfully tagged blog_redis:latest
Building memcached
Step 1/4 : FROM memcached:latest
 ---> b26493421cee
Step 2/4 : LABEL maintainer="Do Quyet Tien <doquyettien@gmail.com>"
 ---> Using cache
 ---> 72a3e4823ce9
Step 3/4 : CMD ["memcached"]
 ---> Using cache
 ---> 9af7ea65fd30
Step 4/4 : EXPOSE 11211
 ---> Using cache
 ---> f80671d587b9
Successfully built f80671d587b9
Successfully tagged blog_memcached:latest
Building elasticsearch
Step 1/2 : FROM docker.elastic.co/elasticsearch/elasticsearch:6.6.0
 ---> 13aa43015aa1
Step 2/2 : EXPOSE 9200 9300
 ---> Using cache
 ---> d262f4a1c818
Successfully built d262f4a1c818
Successfully tagged blog_elasticsearch:latest
Starting blog_php-fpm_1 ... 
Recreating blog_mysql_1 ... 
[2A[2KStarting blog_php-fpm_1 ... [32mdone[0m[2BRecreating blog_redis_1 ... 
Recreating blog_memcached_1 ... 
Recreating blog_nginx_1     ... 
Starting blog_elasticsearch_1 ... 
[5A[2KRecreating blog_mysql_1       ... [32mdone[0m[5B[1A[2KStarting blog_elasticsearch_1 ... [32mdone[0m[1B[3A[2KRecreating blog_memcached_1   ... [32mdone[0m[3B[4A[2KRecreating blog_redis_1       ... [32mdone[0m[4B[2A[2KRecreating blog_nginx_1       ... [31merror[0m[2B
ERROR: for blog_nginx_1  Cannot start service nginx: driver failed programming external connectivity on endpoint blog_nginx_1 (e70fac9110a6591ef6b303981543e6d86dfb99cd6bdcea2b210d33f9daec7799): Bind for 0.0.0.0:8080 failed: port is already allocated

ERROR: for nginx  Cannot start service nginx: driver failed programming external connectivity on endpoint blog_nginx_1 (e70fac9110a6591ef6b303981543e6d86dfb99cd6bdcea2b210d33f9daec7799): Bind for 0.0.0.0:8080 failed: port is already allocated
Encountered errors while bringing up the project.
Copy .env.docker to .env
the input device is not a TTY
Run composer install.
the input device is not a TTY
Create App key.
the input device is not a TTY
Create storage folder and sub folder: app, framework (cache, sessions, views), logs.
the input device is not a TTY
the input device is not a TTY
the input device is not a TTY
the input device is not a TTY
the input device is not a TTY
the input device is not a TTY
the input device is not a TTY
Change mod write 777 for folder and sub of bootstrap and storage folder.
the input device is not a TTY
Run npm install -g pm2.
the input device is not a TTY
Run npm install && npm run production.
the input device is not a TTY
the input device is not a TTY
Run pm2 start queue.sh to monitor queue worker.
the input device is not a TTY
Run migrate & db seed
the input device is not a TTY
the input device is not a TTY
the input device is not a TTY
the input device is not a TTY
the input device is not a TTY
the input device is not a TTY
Build step 'Execute shell' marked build as failure
Finished: FAILURE
